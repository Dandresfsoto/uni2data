extends ../../../base_auth

block title
    | {{title | upper}}


block side_nav_container

    ul(class="collapsible",data-collapsible="accordion")
        li(class="bold waves-effect waves-light button-menu")

            div(class="collapsible-header active")
                i(class="material-icons") local_activity
                | Breadcrums

            div(class="collapsible-body collapsible-body-blue")
                ul
                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light")
                        a(href="/") Inicio
                            i(class="material-icons icon-sican") keyboard_arrow_right

                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light")
                        a(href="/direccion_financiera/") Direcci√≥n financiera
                            i(class="material-icons icon-sican") keyboard_arrow_right

                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light")
                        a(href="../../../../../") Empresas asociadas
                            i(class="material-icons icon-sican") keyboard_arrow_right

                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light ")
                        a(href="../../../../") {{ breadcrum_1 | truncatechars:25 }}
                            i(class="material-icons icon-sican") keyboard_arrow_right

                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light")
                        a(href="../../../") Ordenes de compra
                            i(class="material-icons icon-sican") keyboard_arrow_right

                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light ")
                        a(href="../") {{ breadcrum_2 | truncatechars:25 }}
                            i(class="material-icons icon-sican") keyboard_arrow_right

                    div(class="divider divider-perfil")

                    li(class="bold waves-effect waves-light breadcrum-active")
                        a(href="#") Crear Producto
                            i(class="material-icons icon-sican") check_circle

                    div(class="divider divider-perfil")

block container_principal
    div(class="container",style="margin-top:40px;")
        |{% crispy form %}


block body_script_auth
    script.
        $(document).ready(function () {


            $("#id_productlist").on('keydown', function () {
                $("#name").text(null);
                $("#precio").text(null);
                $("#codigo").text(null);


                $.ajax({
                    type: 'GET',
                    url: '/rest/v1.0/direccion_financiera/products/list/?name=' + $("#id_productlist").val(),
                    success: function (response) {
                        var tercerosArray = response.lista;
                        var dataTerceros = {};
                        for (var i = 0; i < tercerosArray.length; i++) {
                            dataTerceros[tercerosArray[i].name] = tercerosArray[i].flag;
                        }
                        $('input.autocomplete').autocomplete({
                            data: dataTerceros,
                            limit: 5,
                            onAutocomplete: function (val) {
                                var codigo = val.split(' - ')[0];
                                var nombre = val.split(' - ')[1];
                                var precio = parseInt((val.split(' - ')[2]).replace('COL$', '').replace(',', ''));

                                $("label[for='id_name']").addClass('active');
                                $("#id_name").val(nombre);

                                $("label[for='id_price_char']").addClass('active');
                                $("#id_price_char").val(precio);

                                $("label[for='id_codigo']").addClass('active');
                                $("#id_codigo").val(codigo);

                            }
                        });
                    }
                });

            });
        });
